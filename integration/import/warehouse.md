# ![Импорт из ХД](../../images/icons/vendors/dbimport.svg) Импорт из хранилища данных

> `!!! примечание` — статью переделать, информацию брал из [redmine](http://redmine.basegroup.ru/issues/5808).
>> `!!! примечание` — в дальнейшем использую слово *Объект* для *Процессов* и *Измерений* на первой странице мастера, а слово *Элемент* для *Измерений*, *Атрибутов* и *Фактов* на второй странице мастера.

Компонент предназначен для импорта набора данных из [Хранилища данных](https://wiki.loginom.ru/articles/data-warehouse.html).

> **Важно:** Для работы узла требуется предварительно создать [Подключение](../connections/README.md) к *Хранилищу данных* и связать его с входным портом *Подключение*.

## Порты

### Входные порты

* ![Порт подключений](../../images/icons/ports/input_connection_inactive.svg) **Подключение** — принимает параметры подключения к хранилищу данных;
* ![Порт переменных](../../images/icons/ports/optional_input_variable_inactive.svg) **Управляющие переменные** — при необходимости [переменными](../../scenario/variables/control-variables.md) можно задать значения параметров мастера настройки (необязательный порт `— !!! примечание — может удалить, что порт необязательный?`).

### Выходные порты

* ![Выходной порт таблицы](../../images/icons/ports/input_table_inactive.svg) **Набор данных** — Импортированные из хранилища данные.

## Мастер настройки

Позволяет настроить импорт интересуемых данных из хранилища данных.

### Шаг 1. Выбор объекта хранилища данных

```md
картинки ХД — icons/imports/dwh/data-warehouse_18x18.svg
```

* **Подключение** — отображает строку подключения к источнику данных. Не доступна для редактирования.
* **Активировать** — позволяет установить связь с хранилищем данных, если это еще не было сделано. После установления связи кнопка перестает быть активной, а название меняется на *Активировано*.
* **Объекты хранилища данных** — содержит древовидный список (1a-proc-fold.svg) *Процессов* и (1b-izm-fold.svg) *Измерений* из которых необходимо выбрать лишь один объект.
* (альт.) **Объекты хранилища данных** — содержит древовидный список (1a-proc-fold.svg) *Процессов* и (1b-izm-fold.svg) *Измерений* из которых необходимо выбрать лишь один (1a-proc-one.svg) *Процесс* или (1b-izm-one.svg) *Измерение*).

### Шаг 2. Импорт из хранилища данных

На данной странице происходит работа с внутренними элементами объекта, выбранного на предыдущем шаге: измерениями, атрибутами и фактами.

Окно мастера поделено на две области:

* **Доступные элементы** (`!!! примечание — название есть только в редмайне, в приложении списки не имеют заголовков`) — левая часть, содержит список возможных для выбора элементов, соответствующих выбранному на предыдущем шаге объекту;
* **Выбранные элементы** — правая часть с уже выбранными элементами, позволяет указать интересуемые элементы из первого и задать им необходимые условия и значения.

Элемент может присутствовать только в одном списке. Между списками доступно перемещение элементов, в том числе и с помощью перетаскивание (drag&drop).

`!!! примечание — Однако, из уже выбранных элементов нельзя переместить сразу несколько (через Shift), а из доступных — можно.`

### Доступные элементы

* **Параметр** — метка параметра, при наведении курсора мыши появляется полное название метки;
* **Тип** — отображает типа элемента. Может быть (1b.svg) *Измерение*, (1c.svg) *Факт* либо (1d.svg) *Атрибут*.

Список можно отсортировать, нажав по колонке *Параметр* или *Тип*.

`!!! примечание` — наверно, не надо писать следующее?:
Выделить несколько элементов можно удерживая клавишу Shift или Ctrl.

Контекстное меню:

* **Переместить в выбранные** — перемещает в список *Выбранные элементы* выделенный элемент;
* **Переместить в выбранные все** — перемещает в список *Выбранные элементы* все доступные элементы.

### Выбранные элементы

```md
картинка переключатель — icons/imports/dwh/on-off-switcher_28x16.svg
```

* ![Выводить](картинка_переключатель.svg) **Выводить** — определяет будет ли добавлен этот элемент в виде поля в выходной набор данных (если отключено поле добавлено не будет, но по нему можно установить фильтр) (примечание — что значит "можно установить фильтр"? Для чего?);
* **Поле** — тоже что и *Параметр* в *Доступных элементах*;
* **Тип** — тоже что и *Тип* в *Доступных элементах*;
* **Условие** — для *Измерений* и *Атрибутов* позволяет выбирать из выпадающего списка условие фильтрации;
* **Значение** — для *Фактов* отображает выбранные [агрегации](../../processors/func/aggregation-functions.md), для остальных элементов отображается значение фильтрации, если указано условие;
* ![Удалить](../../images/icons/toolbar-controls_18x18/toolbar-controls_18x18_delete_default.svg) **Удалить** — перемещает соотвествующий параметр обратно в список *Доступные элементы*.

Если в поле *Условие* выбран вариант *в списке* или *вне списка*, то в поле *Значение* появится возможность отредактировать список. Нажав на кнопку !!![уточнить](многоточие.svg) откроется окно *Список значений*.

#### Список значений

* ![Получить список](../../images/icons/toolbar-controls_18x18/toolbar-controls_18x18_get-column-list_default.svg) **Получить список** — получает список, соответствующий выбранному элементу;
* ![Выбрать все](../../images/icons/toolbar-controls_18x18/toolbar-controls_18x18_check-all_default.svg) **Выбрать все** — отмечает все строки;
* ![Отменить выбор всех](../../images/icons/toolbar-controls_18x18/toolbar-controls_18x18_uncheck-all_default.svg) **Отменить выбор всех** — убирает выбор всех строк;
* ![Инвертировать выбор](../../images/icons/toolbar-controls_18x18/toolbar-controls_18x18_reverse-check_default.svg) **Инвертировать выбор** — меняет отмеченные и не отмеченные элементы местами;
* ![Добавить](../../images/icons/toolbar-controls_18x18/toolbar-controls_18x18_plus_default.svg) **Добавить** — позволяет добавить в список новую строку;
* ![Редактировать](../../images/icons/toolbar-controls_18x18/toolbar-controls_18x18_edit_default.svg) **Редактировать** — позволяет отредактировать добавленную в список строку.

Очередность элементов можно изменить:

* ![Переместить вверх](../../images/icons/toolbar-controls_18x18/toolbar-controls_18x18_moveup_default.svg) **Переместить вверх** — перемещает выделенный *элемент* вверх по списку;
* ![Переместить вниз](../../images/icons/toolbar-controls_18x18/toolbar-controls_18x18_movedown_default.svg) **Переместить вниз** — перемещает выделенный *элемент* вниз по списку.

Для исключения элемента из списка выбранных:

* Перетащить элемент из списка *Выбранные элементы* в *Доступные элементы*;
* ![Удалить](../../images/icons/toolbar-controls_18x18/toolbar-controls_18x18_delete_default.svg) *Удалить*.

Для очистки всего списка нажать ![Удалить все](../../images/icons/toolbar-controls_18x18/toolbar-controls_18x18_delete-all_default.svg) *Удалить все...*.

Контекстное меню дублирует общие функции:

* Выводить/Не выводить;
* Удалить;
* Удалить все;
* Переместить вверх;
* Переместить вниз.
