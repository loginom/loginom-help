# ![](../../media/app/icons/vendors/wsdlclient.svg) Вызов веб-сервиса

## Описание

Компонент позволяет взаимодействовать с внешним веб-сервисом, отправляя ему запрос и получая ответ. В качестве входного набора данных используется таблица с параметрами запроса, а на выходных портах обработчика формируются таблицы с ответом, возвращенными ошибками и дополнительными данными. Для работы с веб-сервисом необходимо настроенное подключение к веб-сервису, вызов которого предполагается в сценарии.

## Порты

### Входные порты

* ![](../../media/app/icons/ports/input_connection_inactive.svg) Подключение к веб-сервису (связь с компонентом [подключение веб-сервиса](../../integration/web-services/connecting-web-service.md)).
* ![](../../media/app/icons/ports/output_table_inactive.svg) Источник данных запроса (таблица с параметрами запроса).
* ![](../../media/app/icons/ports/optional_input_variable_inactive.svg) Управляющие переменные (переменные), необязательный.

### Выходные порты

* ![](../../media/app/icons/ports/output_table_inactive.svg) Выходной набор данных (таблица с ответом веб-сервиса).
* ![](../../media/app/icons/ports/output_table_inactive.svg) Исключения (WSDL fault).
* ![](../../media/app/icons/ports/output_table_inactive.svg) Дополнительные данные (таблица).

## Настройка

Мастер настройки вызова сервиса состоит из нескольких шагов.

### Настройка запроса

**Выбор метода запроса:**

Необходимо выбрать один из доступных методов запроса, предоставляемых веб-сервисом. Выбранный метод отмечается точкой.

**Настройка запроса:**

На данном шаге задаются параметры запроса. Значения параметров берутся из полей входного набора данных. Необходимо проставить связи между полями и параметрами. Напротив каждого параметра нужно кликнуть по надписи "не связано" и выбрать нужное поле из выпадающего списка. Также можно автоматически настроить связи, нажав кнопку "Связать все автоматически".

### Настройка ответа

**Настройка ответа сервиса:**

Ответ веб-сервиса на этом шаге представлен в виде дерева возвращаемых параметров. Необходимо отметить галочками те параметры, которые будут включены в результирующую таблицу в виде отдельных столбцов.

**Настройка обрабатываемых исключений:**

Информация о возвращаемых ошибках выводится в отдельную таблицу. Галочками отмечаются параметры ошибок, которые будут включены в неё.

### Дополнительные параметры

* Идентификация запроса
  * **Один запрос в каждой строке входного запроса** - каждая строка таблицы представляет один полноценный запрос.
  * **Идентификатор запроса - поле входного набора** - запрос формируется из нескольких строк таблицы. Из выпадающего списка необходимо выбрать поле, которое послужит идентификатором последовательности строк. Это поле должно иметь одинаковые значения в тех строках, которые необходимо включить в один запрос.
* Обработка ответа
  * **Временная зона по умолчанию** - влияет на обработку значений типа дата/время, полученных от веб-сервиса. Если у пришедшего значения отсутствует временная зона, то считается, что она равна временной зоне, которая указана по умолчанию. Если присутствует, то значение преобразуется к указанной временной зоне.
  * **Дублировать единичные значения** - при установленном флаге в группах наряду с узлами, которые могут многократно повторяться, включают также узлы, которые могут присутствовать только в единичном экземпляре (например, атрибуты, дочерние элементы с maxOccurs=1). Значение последних будет дублироваться в каждой строке, т.е. для каждого повторения многократного узла. Если опция отключена, единичные значения будут указываться только в первой строке.
  * **Проверять на строгое соответствие XSD** - при *снятии* данного флага проверка ответа веб-сервиса производится в упрощенном режиме. Фактически проверяются: 1) атрибуция узлов (англ. термин - Particle attribution), 2) правильность типов данных. Большинство проверок осуществляются только для тех узлов, которые были выбраны для импорта. Все эти особенности обеспечивают высокую скорость упрощенного режима. При *установке* флага валидация осуществляется по всем правилам XSD для всего документа независимо от того, требуется ли импортировать его целиком или только какие-то отдельные части.
  * **Генерировать составные метки полей** - если параметр ответа находится в дереве со сложной структурой, то при установленном флаге будут генерироваться метки полей, содержащие полный путь расположения параметра в дереве.
* Дополнительно
  * **Выдавать описание кодов завершения** - отображать или не отображать описание ошибок, произошедших при формировании и отправке запроса, получении и разборе ответа веб-сервиса.
  * **Выдавать "сырой" ответ сервера** -  когда данный флаг установлен, в виде строкового поля наряду с разобранным ответом сервера будет доступен также и неразобранный ответ.
* Отладка
  * **Сохранять текст запроса на диск** - все запросы, отправленные сервису записываются в указанную папку в файловом хранилище.
  * **Имитировать запрос с ответом в файле** - при установке флага фактического запроса к веб-сервису не происходит. Обработчику в качестве заглушки вместо ответа веб-сервиса подставляется указанный файл.