# ![](../../images/icons/vendors/extractxml.svg) Извлечение XML

## Описание

Обработчик извлекает таблицу данных из столбца входной таблицы, в ячейках которого содержатся документы XML в строковом виде. Все документы из столбца должны соответствовать подключенной [XSD-схеме](https://ru.wikipedia.org/wiki/XML_Schema_%28W3C%29).

## Порты

### Вход

* ![](../../images/icons/ports/input_connection_inactive.svg) — Поключение к источнику XSD-схемы — подключение настроенного ранее подключения к файлам [XSD-схем](../../integration/connections/list/schemes.md).
* ![](../../images/icons/ports/optional_input_variable_inactive.svg) —  Управляющие переменные (переменные), необязательный.
* ![](../../images/icons/ports/input_table_inactive.svg) — Источник данных — таблица данных, содержащая ячейки с документами XML.

### Выход

* ![](../../images/icons/ports/output_table_inactive.svg) — Набор данных — таблица данных, извлеченных из документов XML.
  * Поля, наличие которых задается пользователем:
    * Идентификатор поля — показывает, из какого именно документа была извлечена конкретная строка.

* ![](../../images/icons/ports/output_table_inactive.svg) — Ошибки и коды завершения — таблица логов извлечения, имеет следующую структуру:
  * Обязательные поля:
    * Код завершения — содержит значения кодов извлечения для каждого документа.
  * Поля, наличие которых задается пользователем:
    * Идентификатор поля — показывает, какому документу соответствует запись в таблице логов;
    * Описание ошибки — описание кодов завершения.

## Мастер настройки

### Шаг 1. Параметры извлечения XML

* **Столбец, содержащий XML** — выбор столбца с документами XML.

* **Идентификация XML-документа** — в этой области определяется наличие столбца идентификаторов в извлекаемой таблице и в таблице логов:
  * Использовать идентификатор — флаг включает идентификаторы. Далее с помощью радиокнопки определяется тип идентификаторов:
    * Номер строки входного набора — номер строки, в которой содержится документ. Первой строке соответствует идентификатор 0.
    * Значение столбца — в качестве идентификаторов будут использованы значения выбранного столбца входной таблицы.

* **Останавливаться при ошибках** — данный флаг отменит извлечение при обнаружении первой ошибки.

* **Разэкранировать сущности XML** — применяется в том случае, если документы извлекаются из другого документа XML, в котором они были заэкранированы. При отсутствии данного флага извлечение документа, начинающегося, например, с объявления `&lt;`

```xml
&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt
```

выдаст ошибку, а при наличии флага обработчик интерпретирует такое объявление как корректное:

```xml
<?xml version=«1.0» encoding=«UTF-8»?>
```

* **Выдавать описание кодов завершения** — в таблицу с логами будет добавлен столбец "Описание ошибки".

### Шаг 2. Импортируемые поля

* **Подключение** — состояние подключения к XSD-схеме.

* **Корневой элемент** — выбор корневого элемента XSD-схемы, в соответствии с которым данные будут извлекаться. Ниже расположена область, отображающая иерархическую структуру выбранного корневого элемента — в ней следует отметить флагами элементы, которые сформируют поля извлекаемой таблицы.

* **Временная зона по умолчанию** — влияет на извлечение значений типа дата/время следующим образом:
  * Если у исходного значения отсутствует временная зона, то считается, что она равна указанной в свойстве компонента.
  * Если временная зона присутствует, то значение преобразуется к временной зоне, указанной в свойстве компонента.

* **Дублировать единичные значения** — если в составе последовательности имеется единичный элемент и вложенная последовательность, значения единичного элемента будут продублированы для каждой строки, образованной из вложенной последовательности.

* **Проверять на строгое соответствие XSD**:
  * При отсутствии названного флага данные, фактически содержащиеся в документах XML, проверяются на соответствие со структурой схемы и типами данных выходных полей.
  * При наличии флага производится полная валидация документов со схемой.

* **Генерировать составные метки полей** — при наличии данного флага в каждой метке поля будет отражена иерархия относительно корневого элемента. Например, составная метка "ROOT|PERSON|ACCES-LEVEL" будет сформирована для поля извлеченной таблицы, содержащего данные атрибута "ACCESS-LEVEL" элемента "PERSON" из корневого элемента "ROOT" документа. При отсутствии флага поле получит название "ACCESS-LEVEL".