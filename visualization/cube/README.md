# ![Визуализатор Куб](../../images/icons/view_types/cube_default.svg) Куб

[Куб](https://wiki.loginom.ru/articles/cube.html) является одним из распространенных методов комплексного многомерного анализа данных, получивших название [OLAP](https://wiki.loginom.ru/articles/online-analytical-processing.html) (OnLine Analytical Processing). В его основе лежит представление данных в виде многомерных кубов, называемых также OLAP-кубами или гиперкубами.

Куб — это удобное средство визуализации многомерных данных и получения необходимых форм отчетов. Он содержит измерения и факты, определенные при построении. К основной особенности куба относится то, что его структура не является жестко определенной. Манипулируя с помощью мыши заголовками измерений, пользователь может добиться наиболее информативного представления куба.

> **Важно:** во время настройки куба, особенно при работе с большими объемами данных, перестроение куба может занимать продолжительное время. Для временного отключения обновления фактов рекомендуется приостановить автовычисления кнопкой ![](../../images/icons/toolbar-controls/locked_default.svg) *Приостановить автовычисление*.

## Интерфейс

### Операции

* ![](../../images/icons/toolbar-controls/fields-list_default.svg) **Поля** — показать/скрыть список полей набора данных.
* ![](../../images/icons/toolbar-controls/show-fast-viewer_default.svg) **Детализация** — показать/скрыть [детализацию](./details.md).
* ![](../../images/icons/cube/detailing/browse_default.svg) **Способ детализации** — переключить варианты отображения детализации:
  * ![](../../images/icons/cube/detailing/browse_default.svg) **Таблица**.
  * ![](../../images/icons/cube/detailing/form_default.svg) **Форма**.
  * ![](../../images/icons/cube/detailing/stat_default.svg) **Статистика**.
* ![](../../images/icons/toolbar-controls/chart_default.svg) **Диаграмма** — показать/скрыть [диаграмму](./chart.md).
* ![](../../images/icons/toolbar-controls/collapce-all_default.svg) **Свернуть** — свернуть иерархию измерений куба:
  * **Свернуть все**.
  * **Свернуть колонки**.
  * **Свернуть строки**.
* ![](../../images/icons/toolbar-controls/open-all_default.svg) **Развернуть** — развернуть иерархию измерений куба:
  * **Развернуть все**.
  * **Развернуть колонки**.
  * **Развернуть строки**.
* ![](../../images/icons/toolbar-controls/show-total-all_default.svg) **Итоги** — показать/скрыть итоги по кубу:
  * ![](../../images/icons/toolbar-controls/show-total-all_default.svg) **Все**.
  * ![](../../images/icons/toolbar-controls/show-total-col_default.svg) **В колонках**.
  * ![](../../images/icons/toolbar-controls/show-total-row_default.svg) **В строках**.
  * ![](../../images/icons/toolbar-controls/show-total-nor_default.svg) **Нигде**.
* ![](../../images/icons/toolbar-controls/width-equal_default.svg) **Выравнивание ширины колонок**:
  * ![](../../images/icons/toolbar-controls/width-equal_default.svg) **Равная ширина фактов**.
  * ![](../../images/icons/toolbar-controls/width-same_default.svg) **Равная ширина колонок**.
* ![](../../images/icons/toolbar-controls/transform_default.svg) **Транспонировать** — переместить измерения из строк в столбцы и наоборот.
* ![](../../images/icons/cube/cases/case-tune_default.svg) **Настроить факты…** — открыть окно [настройки фактов](./configurefacts.md).
* ![](../../images/icons/cube/cases/case-calc_default.svg) **Добавить вычисляемый факт…** — открыть окно для добавления нового [вычисляемого факта](./addcalculatingfact.md) в куб[^1].
* ![](../../images/icons/cube/cases/case-filter_default.svg) **Фильтровать факты…** — открыть окно для  [фильтрования фактов](./filterfacts.md).
* ![](../../images/icons/cube/cases/case-format_default.svg) **Форматировать факты…** — открыть окно для [форматирования фактов](./formatfacts.md).
* ![](../../images/icons/toolbar-controls/export_default.svg) **XLS** / **HTML**:
  * **экспорт в XLS** — сохранить текущее представление в формате Excel.
  * **экспорт в HTML** — сохранить текущее представление в формате HTML.
* ![](../../images/icons/toolbar-controls/locked_default.svg) **Приостановить автовычисление** — отключить обновление отображения фактов.

[^1]: добавленный ранее вычисляемый факт можно редактировать или удалить в окне *Настройки фактов*.

### Контекстное меню

Указанные операции доступны также через контекстном меню.

Кроме них есть еще:

* ![](../../images/icons/checkbox-states/checked_default.svg) **Скрыть единственный факт** — позволяет скрыть строку с названием факта, если он единственный выбранный.

### Настройка куба

В левом списке отображаются поля, которые можно использовать в качестве измерений и фактов.

#### Измерения

Для построения информативного куба нужно перенести поля в область списков измерений. Количество измерений может варьироваться от нуля до количества доступных полей. Уже используемые измерения можно вернуть обратно в список доступных полей. Рекомендуется использовать не более 5-7 измерений, чтобы отчет был понятным и интерпретируемым.

Добавить измерения в строки или столбцы куба можно двумя способами:

* Перетащить (Drag-and-Drop) поле из левого списка в ту область, в которую его необходимо добавить: строки или столбцы;
* Нажать кнопку ![Добавить](../../images/icons/toolbar-controls/plus-native_default.svg) нужной области и выбрать необходимое поле из списка.

Так как визуализатор Куб представляет собой плоскую двухмерную таблицу, то для отображения нескольких измерений на одной оси используется иерархическая система. Это позволяет детализировать содержание конкретного элемента измерения. Развернуть такой элемент можно кнопкой ![Развернуть](../../images/icons/toolbar-controls/arrow-r_default.svg), находящейся в названии данного элемента, а свернуть — кнопкой ![Свернуть](../../images/icons/toolbar-controls/down_default.svg). Также, свернуть или развернуть до нужного уровня все элементы можно из меню ![Раскрыть меню](../../images/icons/toolbar-controls/down_default.svg) конкретного измерения и выбрав ![Свернуть](../../images/icons/toolbar-controls/collapce-all_default.svg) *Свернуть* или ![Развернуть](../../images/icons/toolbar-controls/open-all_default.svg) *Развернуть*.

Чтобы отсортировать значения измерения, необходимо нажать кнопку ![Раскрыть меню](../../images/icons/toolbar-controls/down_default.svg) рядом с нужным измерением и выбрать необходимый вариант:

* ![](../../images/icons/toolbar-controls/low-to-hight_default.svg) **По возрастанию** — отсортировать значения в порядке возрастания;
* ![](../../images/icons/toolbar-controls/hight-to-low_default.svg) **По убыванию** — отсортировать значения в порядке убывания;
* ![ ](../../images/icons/blank.svg) **В исходном порядке** — выстроить значения в изначальном порядке.

Чтобы отфильтровать данные по измерению необходимо щёлкнуть мышью по нужному измерению, выбрать значения из списка уникальных и нажать "Применить". Если по измерению настроена фильтрация, то оно выделяется оранжевым цветом.

Фильтр может работать в трех режимах:
* ![](../../images/icons/toolbar-controls/icon-200_default.svg) **Множественный выбор** — пользователь может выбрать произвольное количество значений измерения из списка доступных. Выбранные значения будут отображаться в кубе. 
* ![](../../images/icons/toolbar-controls/icon-201_default.svg)
**Одиночный выбор** — позволяет выбрать из списка только одно значение, которое будет отображаться в кубе. 
* ![](../../images/icons/toolbar-controls/icon-202_default.svg) **Комбинированный выбор** — позволяет выбрать одно значение измерения из списка, сформированного ранее в режиме множественного выбора.

По умолчанию задан режим ![](../../images/icons/toolbar-controls/icon-200_default.svg) **Множественный выбор**. Пользователь может выбрать логику выделения значений измерения с помощью переключателя ![]() **Режим включенных/исключенных значений**. 

В режиме ![](../../images/icons/toolbar-controls/icon-200_default.svg) **Множественный выбор** доступны операции:

* ![](../../images/icons/toolbar-controls/visible_default.svg) / ![](../../images/icons/toolbar-controls/invisible_default.svg) **Отметить все/Снять все** — выделяет все значения в списке/снимает выделение со всех значений списка.
* ![](../../images/icons/toolbar-controls/invert-eye_default.svg) **Инвертировать выбор** — меняет выбранные значения списка на невыбранные и наоборот.
* ![](../../images/icons/toolbar-controls/eye-filter_default.svg) **Отметить по маске...** — позволяет задать условие и метод отбора измерений. 

Для настройки отбора открывается окно *Отметить по маске* (в заголовке окна также указано измерение, для которого выполняется настройка). Слева в выпадающем списке необходимо выбрать условие соответствия значений измерения маске. Справка от списка, в поле ввода, задается маска. Ко всем измерениям, которые соответствуют условию, будет применен выбранный метод отбора (*Отметить, Добавить к отмеченным, Снять,* или *Удалить из отмеченных*). При отборе может учитываться регистр букв, для этого нужно установить флаг *Учитывать регистр*.

В режимах ![](../../images/icons/toolbar-controls/icon-201_default.svg)
**Одиночный выбор** и ![](../../images/icons/toolbar-controls/icon-202_default.svg) **Комбинированный выбор** справа от наименования измерения становится доступна кнопка ![Развернуть](../../images/icons/toolbar-controls/arrow-r_default.svg), которая позволяет листать список значений (при этом можно задать цикличность перемещения по списку, нажав кнопку ![](../../images/icons/toolbar-controls/roll-over_default.svg) **Зациклить значения при перелистывании**). Куб будет перестраиваться при перемещении на новое значение измерения. 

Измерение можно исключить из куба, для этого нужно нажать кнопку ![Раскрыть меню](../../images/icons/toolbar-controls/down_default.svg) рядом с нужным измерением и выбрать команду ![Удалить](../../images/icons/toolbar-controls/delete_default.svg) *Удалить* или перетащить (Drag-and-Drop) измерение в список *Поля* в левой части экрана.

> **Примечание:** над областью настройки измерений куба находится область фильтрации. Она заполняется также и имеет те же параметры сортировки и фильтрации, что и область настройки измерений. Измерения добавленные в эту область не будут отображаться в кубе, но могут быть использованы в вычисляемых фактах и для фильтрации данных.

#### Факты

Добавить факты можно двумя способами:

* Перетащить (Drag-and-Drop) поле из левого списка в область фактов куба (область пересечения строк и столбцов);
* Нажать кнопку ![Факты](../../images/icons/toolbar-controls/sum_default.svg) Факты, выбрать необходимое поле и в появившемся [окне](./addfact.md) выбрать нужный вариант [агрегации](../../processors/func/aggregation-functions.md) и способ его отображения.

Нажав на кнопку ![Раскрыть список](../../images/icons/toolbar-controls/down_default.svg) рядом с ![Факты](../../images/icons/toolbar-controls/sum_default.svg) Факты можно открыть одно из окон:

* ![Настроить факты](../../images/icons/cube/cases/case-tune_default.svg) **Настроить факты…** — открыть окно настройки фактов;
* ![Добавить вычисляемый факт](../../images/icons/cube/cases/case-calc_default.svg) **Добавить вычисляемый факт…** — открыть окно для добавление вычисляемого факта в куб;
* ![Фильтровать факты](../../images/icons/cube/cases/case-filter_default.svg) **Фильтровать факты…** — открыть окно для фильтрования фактов;
* ![Форматировать факты](../../images/icons/cube/cases/case-format_default.svg) **Форматировать факты…** — открыть окно для форматирования фактов.

Удалить факт можно в окне *Настроить факты*.

>**Примечание:** по умолчанию в качестве варианта агрегации и способа его отображения выбирается идущий первым по списку. Поддерживается отображение сразу нескольких вариантов агрегации и способов их отображения для каждого факта.