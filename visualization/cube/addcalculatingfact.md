# ![Вычисляемый факт](../../images/icons/cube/cases/case-calc_default.svg) Вычисляемый факт

Позволяет добавить свой факт в куб. Вычисляется на основе используемых в кубе и области фильтрации измерений и фактов.

Необходимо задать:

* **Имя** — строка, которая будет служить идентификатором в процедурах обработки;
* **Метка** — строка, под которой факт будет виден в кубе и диаграмме;
* **Тип данных** — тип данных вычисляемого выражения;
* **Метка функции** — значок для вычисляемого выражения.

## Область кода выражения

В области кода задается формула расчета выражения. Ссылки на измерения, факты и синтаксические конструкции функций можно вставлять в код выражения, выбрав их двойным кликом мыши в соответствующих областях, либо написав вручную.

Формула выражения может содержать:

* ссылки на используемые измерения и факты куба в виде наименования измерений и фактов;
* варианты агрегации измерений и фактов;
* скобки, определяющие порядок выполнения операций;
* знаки математических операций и отношений;
* логические операции (AND, OR, NOT, XOR) и значения (true или 1, false или 0);
* функции в соответствии с синтаксическим описанием ([Список функций](#spisok-funktsiy));
* строковые выражения в кавычках ("строковое выражение");
* целые и вещественные числа;
* однострочные и многострочные комментарии.

Однострочный комментарий начинается символами `//` (два слеша) и продолжается до конца строки. Многострочным комментарием считаются все символы, содержащиеся между `/*` (слеш-звездочка) и `*/` (звездочка-слеш).

## Список измерений и фактов

Область содержит список измерений и фактов, которые можно использовать в вычисляемых фактах.

Двойной клик мыши по позиции дерева измерений и фактов вводит имя измерения или факта с выбранной функцией агрегации в область кода выражения. То же самое можно сделать, написав имя измерения или факта в область кода вручную.

Новый факт создается на основе манипулирования фактами и измерениями при помощи доступных функций, а также ряда переменных, доступных для каждого измерения:

* **Значение** (*Имя измерения.Value*) — значение измерения.
* **Количество** (*Имя измерения.Count*) — количество уникальных значений измерения.
* **Итог** (*Имя измерения.IsTotal*) — проверка, является ли текущее значение измерения итогом. Переменная используется совместно с функциями *IF()/IFF()*, чтобы в итогах вычисляемого факта расчитывать показатели по пользовательским правилам.
* **Пусто** (*Имя измерения.IsNull*) — проверка, является ли текущее значение пустым. 

Внутри фактов, в свою очередь, имеется доступ к итоговым значениям по каждому измерению. 

> **Примечание:** в списке будут доступны только используемые факты и измерения. Измерения, которые не были перенесены в строки, столбцы или область фильтрации, в списке доступны не будут.

## Список функций

Область содержит наименование, входные аргументы и описание [доступных для использования функций](../../processors/func/calc-func/README.md).

Возможна фильтрация по категории и названию функции.

Двойной клик мыши по позиции выбранной функции вставляет ее синтаксис в область кода выражения. То же самое можно сделать, перетащив функцию из списка в область кода (Drag-and-Drop).
