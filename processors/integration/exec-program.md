# Выполнение программы

## Описание

С помощью компонента "Выполнение программы" можно выполнить внешнюю программу (запустить на выполнение исполняемый файл): cmd, bat, exe и т.д.

>**Важно:** Этот компонент небезопасный, так как предоставляется доступ к программам и файловой системе! Права на эту операцию задаются в ["Админиcтрировании"](../../admin/parameters.md).

## Порты

### Вход

* ![](../../images/icons/ports/optional_input_variable_inactive.svg) **Входные переменные** — имена переменных можно использовать в "Командной строке", т.е. поддерживается макроподстановка команд: `%ИмяПеременной%` — переменная, содержащая команду, которая подается на вход данного узла (см. [Примеры](#primery)).
* ![](../../images/icons/ports/optional_input_variable_inactive.svg) **Управляющие переменные** — их можно использовать для задания таких параметров, как "Тайм-аут выполнения узла" и "Завершить программу по тайм-ауту".

### Выход

* ![](../../images/icons/ports/optional_output_variable_inactive.svg) Исходные переменные и переменные, содержащие информацию об успешности выполнения программы:
  *  <span title="Целый"><img src="../../images/icons/datatype_18/datatype_default-02.svg"></span>  **Результат выполнения** — переменная целого типа, содержащая значение 0 в случае успешного завершения выполняемой программы;
  *  <span title="Строковый"><img src="../../images/icons/datatype_18/datatype_default-01.svg"></span> **Сообщение об ошибке** — переменная строкового типа, содержащая сообщение об ошибке, если она произошла при выполнении или подготовке в выполнению программы.

## Мастер настройки узла

* Тайм-аут выполнения узла (мсек.) — устанавливает время выполнения узла:
  * **0** — тайм-аут отключен.
  * **1 и более** — количество миллисекунд через которые узел перестанет выполняться. Стрелками можно увеличивать или уменьшать тайм-аут с интервалом в 100 миллисекунд.
  * **Бесконечность** — в этом случае узел будет выполняться до тех пор, пока программа не будет выполнена или закрыта. Если таймаут был изменен и необходимо вернуть его в значение "Бесконечность", то нужно в поле тайм-аут ввести "-1".
* Завершить программу по тайм-ауту — переключатель позволяет включать/отключать тайм-аут выполнения узла.

## Написание команд

В поле "Текст команды" следует вводить команду следующим образом:

* Если это стандартная программа Windows:
  * `cmd.exe` — указывается название программы и ее расширение.
* Если это сторонняя программа:
  * `C:\Program Files (x86)\Microsoft Office\Office14\EXCEL.EXE` — указывается абсолютный путь до исполняемого файла.

Для выполнения команд через cmd.exe необходимо указывать соответствующие ключи:

* `/C` — выполнение указанной команды с последующим завершением;
* `/K` — выполнение указанной команды без последующего завершения.

Другие ключи запуска можно посмотреть на соответствующих сайтах по командной строке WIndows.

### Текущий каталог проекта

Текущим каталогом для процесса, запускаемого узлом "Выполнение программы" считается текущий каталог [файлового хранилища](../../location_user_files.md) пакета.

* Если пакет сохранен, то текущий каталог — это каталог, в котором находится файл пакета;
* Если пакет не сохранен:
  * В Desktop версии приложения текущий каталог совпадает с текущим каталогом Loginom. В [файловом хранилище](../../location_user_files.md) текущий каталог — пустая строка, корень файловой системы.
  * На сервере Loginom текущий каталог совпадает с каталогом пользователя.

### Примеры

Пример создания директории через командную строку:

`cmd.exe /C mkdir D:\Dir\`

Пример макроподстановки:

`cmd.exe /C %ИмяПеременной%`

Где `%ИмяПеременной%` — переменная, содержащая любую команду для выполнения в командной строке Windows.