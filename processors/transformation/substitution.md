# ![](../../media/app/icons/vendors/replacecolumns.svg) Замена

## Описание

Обработчик заменяет данные исходного набора, используя таблицы замен. Таблицы замен содержат пары заменяемых и новых значений или вычисляющие их регулярные выражения. Эти таблицы можно задать вручную в мастере настройки (внутренние) или подать на вход обработчика (внешние).

Последовательность действий алгоритма замены:

 1. Вначале производится поиск и замена по [точному совпадению](../../processors/transformation/substitution/exact_match.md) со значениями, указанными в таблице замен.
 2. Среди значений, не найденных по точному совпадению, производится поиск по [регулярным выражениям](../../processors/transformation/substitution/regexp_match.md). Такие выражения могут быть заданы во внутренних таблицах замен. Новые значения также вычисляются регулярными выражениями.
 3. Выполняются правила замены для значений, не найденных на предыдущих шагах.

### Вход

* ![](../../media/app/icons/ports/output_table_inactive.svg) - набор данных, подлежащий изменению.

* ![](../../media/app/icons/ports/output_table_inactive.svg) - набор данных, содержащий таблицу замен.

* ![](../../media/app/icons/toolbar_18/add_inactive.svg) Добавление еще одного порта. Поскольку таблиц замен может быть несколько, то необходимые порты для них могут быть добавлены пользователем.

### Выход

* ![](../../media/app/icons/ports/output_table_inactive.svg).

## Мастер настройки

Окно мастера настройки состоит из 3-х областей:

 1. [Способы замен](#способы_замен)
 2. [Таблица замен](#таблица замен)
 3. [Дополнительные параметры](#дополнительные параметры)

### Способы замен

Для каждого поля исходного набора задается способ замены:

* **Не заменять** - замены производиться не будут.

* **Ввод вручную** - используется внутренняя таблица замен.

* **Таблица замен** (//Таблица замен N//) - используется внешняя таблица замен. Данный способ присутствует в настройках, если на входной порт обработчика подаются данные внешней таблицы замен. *Таблица замен N* - наименование принимающего таблицу порта.

### Таблица замен

Отображает внешнюю или внутреннюю таблицу замен для выбранного поля исходного набора.

#### Настройка внутренней таблицы

Для ввода новой строки в таблице замены используется кнопка ![](../../media/app/icons/toolbar_18/toolbar_18_27.svg). Таблица может содержать строки для поиска и замены по:

* [точному совпадению](../../processors/transformation/substitution/exact_match.md);

* [регулярному выражению](../../processors/transformation/substitution/regexp_match.md) (применимо только к данным строкового типа).

При вводе вручную таблицы замены доступны ряд действий через панель инструментов области:

* ![](../../media/app/icons/toolbar_18/toolbar_18_137.svg);

* ![](../../media/app/icons/toolbar_18/toolbar_18_41.svg) **Экспорт** - экспорт таблицы замен в текстовый файл;

* ![](../../media/app/icons/toolbar_18/toolbar_18_116.svg) **Сортировка** - сортировка таблицы по полю исходного значения;

* **Изменить тип замены** - задает тип данных столбца с новыми значениями;

* ![](../../media/app/icons/toolbar_18/toolbar_18_28.svg) **Редактировать текущую замену** - отображает область редактирования текущей строки таблицы подстановок.

#### Настройка внешней таблицы

Для полей таблицы необходимо выбрать *Назначение* из следующих вариантов:

* ![](../../media/app/processors/substitution-04.svg) **Не используемое** - поле таблицы замен не будет использоваться;

* ![](../../media/app/processors/substitution-09.svg) **Значение** - поле содержит заменяемые значения;

* ![](../../media/app/processors/substitution-08.svg) **Замена** - поле содержит новые значения;

* ![](../../media/app/processors/substitution-03.svg) **Информационное** - поле содержит дополнительный вариант нового значения. Дополнительные варианты замены выводятся в результирующем наборе данных отдельным столбцом.

--------

**Важно:**

1. Замена по точному совпадению имеет приоритет перед заменой по регулярному выражению.
2. Если замена одного значения может быть произведена по условиям нескольких строк таблицы замен, то приоритет имеет первая из них. В связи с этим *сортировка таблицы замен может влиять на результат обработки*. Данное правило не применяется при использовании [допустимого интервала](./substitution/exact_match.md#primenenie-dopustimogo-intervala) (см. параметр "Точность").

### Дополнительные параметры

* **Заменять остальные** - содержит варианты замены значений, не найденных при помощи таблицы замен:
  * *Не заменять* - замены производиться не будут;
  * *На пропущенное* - значения будут заменены на Null;
  * *На значение* - значения будут заменены на указанное;
  * *На регулярное выражение* - новое значение будет вычислено с использованием [синтаксиса регулярного выражения](./substitution/syntax_regexp.md).

* **Точность** - для полей целого и вещественного типов задает допустимый интервал от указанных в таблицах замен значений, при котором исходное значение будет заменено. См. [применение допустимого интервала](./substitution/exact_match.md#primenenie-dopustimogo-intervala).

* **Регистрозависимые строки** - флаг устанавливает регистрозависимый режим поиска значений в таблицах замен. По умолчанию данный режим не используется.
