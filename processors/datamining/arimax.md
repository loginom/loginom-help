# ARIMAX

## Описание

Модель ARIMAX это модель прогнозирования авторегрессии проинтегрированного скользящего среднего с учетом внешнего фактора.

[ARIMA](https://ru.wikipedia.org/wiki/ARIMA)—модели позволяют моделировать интегрированные или разностно—стационарные временные ряды (DS—ряды, diference stationary).

Для получения результирующих наборов требуется предварительное обучение обработчика.

## Порты

### Вход
* ![](../../media/app/icons/ports/table-inactive.svg) — Входной источник данных (таблица данных). Обязательный порт.

#### Требования к принимаемым данным

Поле, соответствующее временному ряду, должно иметь тип использования &quot;Выходное&quot;, тип данных &quot;Вещественный&quot;  и вид данных &quot;Непрерывный&quot;. Такое поле должно быть ровно одно;

Поля, соответствующие дополнительным входным факторам, должны иметь тип использования &quot;Входное&quot;. Ограничения на типы и виды данных не накладываются. Данные поля могут отсутствовать или присутствовать в любом количестве.

### Выход

* ![](../../media/app/icons/ports/table-inactive.svg) — **Выход модели.**

Таблица, состоящая из полей:

* Имя\_поля|Прогноз — прогнозируемые значения, как для присутствующих в наборе отсчетов временного ряда, так и для &quot;будущих значений&quot;;
* Имя\_поля|Ошибка аппроксимации — остатки модели, только для фактических данных. Поле присутствует, если установлен флаг &quot;Рассчитать ошибку аппроксимации&quot;;
* Имя\_поля|Нижняя граница, Имя\_поля|Верхняя граница — границы доверительного интервала. Поля присутствуют, если установлен флаг &quot;Рассчитать доверительный интервал&quot;.
* Все поля исходного набора данных, независимо от назначения поля.

* ![](../../media/app/icons/ports/table-inactive.svg) — **Коэффициенты модели.**

Таблица, состоящая из полей:

* Параметр
* Коэффициент
* Стандартное отклонение
* T—статистика
* P—value

* ![](../../media/app/icons/ports/output-variable-inactive.svg) — **Сводка**

Содержит следующие показатели:

* Всего примеров (TotalSamples)
* Всего отобранных примеров (TotalSelectedSamples)
* Примеров в обучающем множестве (TrainSamples)
* Среднеквадратическая ошибка на обучающем множестве (TrainRMSError)
* Средняя абсолютная ошибка на обучающем множестве (TrainAvgError)
* Средняя относительная ошибка на обучающем множестве (TrainAvgRelError)
* Информационный критерий Акаике (AIC)
* Информационный критерий Акаике скорректированный (AICc)
* Информационный критерий Байеса (BIC)
* Коэффициент детерминации (R2)
* Скорректированный коэффициент детерминации (AjustedR2)
* Число степеней свободы модели (ModelDF)
* Число степеней свободы остатков (ResDF)

## Мастер настройки

### Шаг 1. Назначение входных столбцов

На первом этапе необходимо задать [назначение](../../data/datasetfieldoptions.md) полей входного набора данных.
Для каждого из полей можно выбрать один из вариантов назначения:

* ![](../../media/app/icons/toolbar-18/used-1.svg) **Входное** — поля, соответствующие дополнительным входным факторам;
* ![](../../media/app/icons/toolbar-18/used-2.svg) **Выходное** — поле, соответствующее временному ряду;
* ![](../../media/app/processors/substitution-03.svg) **Неиспользуемое** — поле не участвует в обработке. Устанавливается по умолчанию для прочих полей.

### Шаг 2. Настройки ARIMAX

#### Структура модели ARIMAX

* **Определить структуру автоматически.**
Автоматический подбор модели следует приводимой ниже процедуре:

1.Определяются порядки интегрирования:
 * DS (для сезонной компоненты) — на основе Canova—Hansen теста;
 * D (для несезонной компоненты) — на основе KPSS теста.

2.Если D + DS ≤ 1 константа добавляется в модель.

3.Начальная модель определяется как лучшая из:
 * ARIMA(2,D,2) при отсутствии сезонности и ARIMA(2,D,2)(1,DS,1) при ее наличии;
 * ARIMA(0,D,0) при отсутствии сезонности и ARIMA(0,D,0)(0,DS,0) при ее наличии. Если в модель не включена константа, а также отсутствуют внешние факторы, то этот вариант не рассчитывается (иначе в нем отсутствовали бы подбираемые параметры);
 * ARIMA(1,D,0) при отсутствии сезонности и ARIMA(1,D,0)(1,DS,0) при ее наличии;
 * ARIMA(0,D,1) при отсутствии сезонности и ARIMA(0,D,1)(0,DS,1) при ее наличии.

4.На каждом шаге проверяются варианты:
 * Изменение авторегрессии, скользящего среднего, авторегрессии  и скользящего среднего  для сезонной части на ±1 по отдельности;
 * Изменение авторегрессии и скользящего среднего на ±1 одновременно;
 * Изменение авторегрессии  и скользящего среднего  для сезонной части на ±1 одновременно.

5.Ограничения на структуру модели: авторегрессии &lt; 6, скользящего среднего &lt; 6, авторегрессии для сезонной части &lt; 3, скользящего среднего  для сезонной части &lt; 3.
При авто подборе в качестве модели—кандидата выбирается такой вариант, который минимизирует AIC. Если AIC модели—кандидата меньше AIC текущей выбранной модели, модель—кандидат становится новой выбранной моделью и процесс продолжается. Иначе процедура завершается.

* **Порядок AR части.** Параметр доступен при отключенном значении: Определить структуру автоматически. Устанавливается значение целого типа от 0 и выше.
* **Порядок интегрирования.** Параметр доступен при отключенном значении: Определить структуру автоматически. Устанавливается значение целого типа от 0 и выше.
* **Порядок MA части.** Параметр доступен при отключенном значении: Определить структуру автоматически. Устанавливается значение целого типа от 0 и выше.
* **Включить расчет сезонности.**
* **Порядок сезонной AR части.** Параметр доступен при отключенном значении: Определить структуру автоматически и включенном значении: Включить расчет сезонности. Устанавливается значение целого типа от 0 и выше.
* **Порядок сезонного  интегрирования.** Параметр доступен при отключенном значении: Определить структуру автоматически и включенном значении: Включить расчет сезонности. Устанавливается значение целого типа от 0 и выше.
* **Порядок сезонной MA части.** Параметр доступен при отключенном значении: Определить структуру автоматически и включенном значении: Включить расчет сезонности. Устанавливается значение целого типа от 0 и выше.
* **Период сезонной составляющей.** Параметр доступен включенном значении: Включить расчет сезонности. Устанавливается положительное значение целого типа.
* **Включить константу в модель.** Параметр доступен при отключенном значении: Определить структуру автоматически.

#### Прогнозирование временных рядов

* **Горизонт прогноза.** Количество отсчетов, которые будут спрогнозированы в конце временного ряда. Устанавливается положительное значение целого типа.
* **Рассчитать ошибку аппроксимации.**
* **Рассчитать доверительный интервал.**
* **Доверительный интервал прогноза в %.** Параметр доступен при включенном значении: Рассчитать доверительный интервал. Устанавливается значение целого типа в интервале от 0 до 100.