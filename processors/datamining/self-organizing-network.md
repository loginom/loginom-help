# ![ ](../../images/icons/components/sonn_default.svg) Самоорганизующиеся сети

## Описание

Самоорганизующиеся сети позволяют выявлять [кластеры](https://wiki.loginom.ru/articles/cluster.html) (группы) входных векторов, обладающих некоторыми общими свойствами. Таким образом, они хорошо подходят для кластерного анализа.

К самоорганизующимся сетям относятся, в частности, [сети Кохонена](https://wiki.loginom.ru/articles/kohonen-network.html). Сети Кохонена представляют собой разновидность самоорганизующихся карт признаков, которые, в свою очередь, являются специальным типом нейронных сетей. Сеть Кохонена состоит из узлов, которые объединяются в кластеры. Наиболее близкие узлы соответствуют похожим объектам, а удаленные друг от друга - непохожим.

В основе построения сети Кохонена лежит конкурентное обучение, когда выходные узлы (нейроны) конкурируют между собой за право стать «победителем». Говорят, что нейроны избирательно настраиваются для различных входных примеров или классов входных примеров в ходе соревновательного процесса обучения.
Входные нейроны образуют входной слой сети, который содержит по одному нейрону для каждого входного поля. Как и в обычной нейронной сети, входные нейроны не участвуют в процессе обучения. Их задача - передать значения входных полей исходной выборки на нейроны выходного слоя. Каждая связь между нейронами сети имеет определенный вес, который в процессе ее инициализации устанавливается случайным образом в интервале от 0 до 1. Процесс обучения заключается в подстройке весов.
Однако в отличие от большинства нейронных сетей других видов сеть Кохонена не имеет скрытых слоев: данные с входного слоя передаются непосредственно на выходной, нейроны которого упорядочены в одномерную или двумерную решетку прямоугольной или шестиугольной формы.

Также одним из типов самоорганизующихся сетей является [нейронный газ](https://ru.wikipedia.org/wiki/%D0%9D%D0%B5%D0%B9%D1%80%D0%BE%D0%BD%D0%BD%D1%8B%D0%B9_%D0%B3%D0%B0%D0%B7). Нейронный газ — это алгоритм, позволяющий осуществлять адаптивную кластеризацию входных данных, то есть не только разделить пространство на кластеры, но и определить необходимое их количество, исходя из особенностей самих данных. Применение алгоритма не требует априорной информации о данных, таких как оценка количества кластеров или форма кластеров. В данной модели соседство узлов не фиксировано, а динамически меняется по мере улучшения кластеризации. Переменными являются не только отношения соседства, но и число нейронов-кластеров.

Для получения результирующих наборов требуется предварительное [обучение обработчика](../../scenario/training-processors.md).

## Порты

### Вход

* ![ ](../../images/icons/ports/input_table_inactive.svg) — Входной источник данных (таблица данных). Обязательный порт.

#### Требования к принимаемым данным

Поле будет запрещено к использованию, если:

* оно является дискретным и содержит всего одно уникальное значение;
* оно непрерывное и с нулевой дисперсией;
* оно содержит пропущенные значения.

### Выход

 ![ ](../../images/icons/ports/output_table_inactive.svg) — **Разбиение на кластеры.**

Таблица, состоящая из полей:

* Номер кластера - каждому объекту присвоен номер того кластера, в который он входит. Кластер состоит из узлов сети.
* Номер узла - каждому объекту присвоен номер узла сети, к которому он относится. Узлы в свою очередь объединяются в кластеры (поле "Номер кластера").
* Расстояние до узла - евклидово расстояние до ближайшего узла, т.е. того, которому принадлежит объект.
* Все поля исходного набора данных, независимо от назначения поля.

 ![ ](../../images/icons/ports/output_table_inactive.svg) — **Координаты узлов.**

Таблица, состоящая из полей:

* Номер узла - перечислены номера сформированных узлов.
* Номер кластера - перечислены номера сформированных кластеров.
* Поля исходного набора данных, для которых значение параметра «Назначение» выбрано «Используемое». В ячейках полей указаны веса узлов сети.

## Мастер настройки

* **Выбор полей для кластеризации.**
  * Для полей, участвующих в кластеризации, выставить назначение "Используемое" ("Активное").
  * Для прочих полей оставить "Не задано".
* **Тип самоорганизующейся сети**: сеть Кохонена и нейронный газ. При выборе типа сети "Нейронный газ" блокируется настройка "Параметров сети".
* **Топология сети**: 1D, 2D прямоугольная, 2D гексагональная, 3D.
* **Размер сети по X**. Параметр доступен для редактирования при любой топологии сети. Устанавливается значение целого типа в интервале от 2 до 100. По умолчанию - 3.
* **Размер сети по Y**. Параметр доступен для редактирования при топологиях сети: 2D прямоугольная, 2D гексагональная, 3D. Устанавливается значение целого типа в интервале от 2 до 100. По умолчанию - 3.
* **Размер сети по Z**. Параметр доступен для редактирования при топологии сети: 3D. Устанавливается значение целого типа в интервале от 2 до 100. По умолчанию - 3.
